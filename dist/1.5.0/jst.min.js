(function(global,undefined){var __features={STRING_INDEX_ENUMERABLE:"abc".propertyIsEnumerable("1"),ACCESSORS:Object.prototype.__defineGetter__&&Object.prototype.__defineSetter__,DOM:typeof window==="object"&&typeof document==="object"};var __propertyIsEnumerable=function(obj,property){if(obj.propertyIsEnumerable){return obj.propertyIsEnumerable(property)}for(var key in obj){if(key===property&&(obj.hasOwnProperty?obj.hasOwnProperty(property):true)){return true}}return false};Function.prototype.bind||(Function.prototype.bind=function(ctx){if(typeof this!=="function"){throw new TypeError("'this' is not a function")}var fn=this,args=$AP.slice.call(arguments,1);return function(){return fn.apply(ctx,args.concat(Array.prototype.slice.call(arguments)))}});String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s\s*/,"").replace(/\s\s*$/,"")});Array.isArray||(Array.isArray=function(obj){return Object.prototype.toString.call(obj)==="[object Array]"||(obj instanceof Array)});var $AP=Array.prototype;$AP.indexOf||($AP.indexOf=function(searchElement){var len=this.length,i=+arguments[1]||0;if(len===0||isNaN(i)||i>=len){return -1}if(i<0){i=len+i;i<0&&(i=0)}for(;i<len;++i){if(this.hasOwnProperty(String(i))&&this[i]===searchElement){return i}}return -1});$AP.lastIndexOf||($AP.lastIndexOf=function(searchElement){var len=this.length,i=+arguments[1]||len-1;if(len===0||isNaN(i)){return -1}if(i<0){i=len+i}else{if(i>=len){i=len-1}}for(;i>=0;--i){if(this.hasOwnProperty(String(i))&&this[i]===searchElement){return i}}return -1});$AP.every||($AP.every=function(callback){if(!__isCallable(callback)){throw new TypeError(callback+" is not a callable object")}var thisArg=arguments[1];for(var i=0,len=this.length;i<len;++i){if(this.hasOwnProperty(String(i))){if(!callback.call(thisArg,this[i],i,this)){return false}}}return true});$AP.some||($AP.some=function(callback){if(!__isCallable(callback)){throw new TypeError(callback+" is not a callable object")}var thisArg=arguments[1];for(var i=0,len=this.length;i<len;++i){if(this.hasOwnProperty(String(i))){if(callback.call(thisArg,this[i],i,this)){return true}}}return false});$AP.forEach||($AP.forEach=function(callback){if(!__isCallable(callback)){throw new TypeError(callback+" is not a callable object")}var thisArg=arguments[1];for(var i=0,len=this.length;i<len;++i){if(this.hasOwnProperty(String(i))){callback.call(thisArg,this[i],i,this)}}});$AP.map||($AP.map=function(callback){if(!__isCallable(callback)){throw new TypeError(callback+" is not a callable object")}var thisArg=arguments[1],len=this.length,results=new Array(len);for(var i=0;i<len;++i){if(this.hasOwnProperty(String(i))){results[i]=callback.call(thisArg,this[i],i,this)}}return results});$AP.filter||($AP.filter=function(callback){if(!__isCallable(callback)){throw new TypeError(callback+" is not a callable object")}var thisArg=arguments[1],len=this.length,results=[];for(var i=0;i<len;++i){if(this.hasOwnProperty(String(i))){callback.call(thisArg,this[i],i,this)&&results.push(this[i])}}return results});$AP.reduce||($AP.reduce=function(callback){if(!__isCallable(callback)){throw new TypeError(callback+" is not a callable object")}var len=this.length;if(len===0&&arguments.length<2){throw new TypeError("reduce of empty array with no initial value")}var initIdx=-1;if(arguments.length<2){if((initIdx=__firstIndex(this))===-1){throw new TypeError("reduce of empty array with no initial value")}}var val=arguments.length>1?arguments[1]:this[initIdx];for(var i=initIdx+1;i<len;++i){if(this.hasOwnProperty(String(i))){val=callback(val,this[i],i,this)}}return val});$AP.reduceRight||($AP.reduceRight=function(callback){if(!__isCallable(callback)){throw new TypeError(callback+" is not a callable object")}var len=this.length;if(len===0&&arguments.length<2){throw new TypeError("reduce of empty array with no initial value")}var initIdx=len;if(arguments.length<2){for(var k=len-1;k>=0;--k){if(this.hasOwnProperty(String(k))){initIdx=k;break}}if(initIdx===len){throw new TypeError("reduce of empty array with no initial value")}}var val=arguments.length>1?arguments[1]:this[initIdx];for(var i=initIdx-1;i>=0;--i){if(this.hasOwnProperty(String(i))){val=callback(val,this[i],i,this)}}return val});Date.now||(Date.now=function(){return +new Date});Date.prototype.toISOString||(Date.prototype.toISOString=(function(){var str=function(n,l){var str=String(n),len=l||2;while(str.length<len){str="0"+str}return str};return function(){return isFinite(this.getTime())?String(this.getUTCFullYear()).concat("-",str(this.getUTCMonth()+1),"-",str(this.getUTCDate()),"T",str(this.getUTCHours()),":",str(this.getUTCMinutes()),":",str(this.getUTCSeconds()),".",str(this.getUTCMilliseconds(),3),"Z"):"Invalid Date"}})());Date.prototype.toJSON||(Date.prototype.toJSON=function(key){if(!isFinite(this)){return null}if(!this.toISOString||typeof this.toISOString!=="function"){throw new TypeError("Date.prototype.toJSON called on incompatible "+(typeof this))}return this.toISOString()});if(!Object.getPrototypeOf){if("".__proto__){Object.getPrototypeOf=function(obj){if(!__isObject(obj)){throw new TypeError(obj+" is not an object")}return obj.__proto__}}else{Object.getPrototypeOf=function(obj){if(!__isObject(obj)){throw new TypeError(obj+" is not an object")}return obj.constructor?obj.constructor.prototype:null}}}Object.create||(Object.create=(function(){var __TmpConstructor=function(){};return function(proto,properties){if(!__isObject(proto)){throw new TypeError(proto+" is not an object")}__TmpConstructor.prototype=proto;var obj=new __TmpConstructor();properties&&Object.defineProperties(obj,properties);return obj}})());Object.isSealed||(Object.isSealed=function(obj){if(!__isObject(obj)){throw new TypeError(obj+" is not an object")}return false});Object.isFrozen||(Object.isFrozen=function(obj){if(!__isObject(obj)){throw new TypeError(obj+" is not an object")}return false});Object.isExtensible||(Object.isExtensible=function(obj){if(!__isObject(obj)){throw new TypeError(obj+" is not an object")}return true});Object.getOwnPropertyDescriptor||(Object.getOwnPropertyDescriptor=(function(){var __NUMBER_CONSTS=["MAX_VALUE","MIN_VALUE","NaN","POSITIVE_INFINITY","NEGATIVE_INFINITY"],__MATH_CONSTS=["PI","E","LN2","LOG2E","LOG10E","SQRT1_2","SQRT2"];return function(obj,pname){if(!__isObject(obj)){throw new TypeError(obj+" is not an object")}if(!(pname in obj)){return}var editable=true,configurable=true;if((obj===Number&&__NUMBER_CONSTS.indexOf(pname)>=0)||(obj===Math&&__MATH_CONSTS.indexOf(pname)>=0)||(pname=="length"&&(obj===String.prototype||__isString(obj)||obj===Function.prototype||obj instanceof Function))){editable=false;configurable=false}else{if(pname=="length"&&(obj===Array.prototype||Array.isArray(obj))){configurable=false}}return{writable:editable,enumerable:__propertyIsEnumerable(obj,pname),configurable:configurable,value:obj[pname]}}})());(!Object.defineProperty||!Object.defineProperties)&&(function(){var __applyDefaults=function(desc,defaultValue,value){if(desc.hasOwnProperty("get")||desc.hasOwnProperty("set")){throw new TypeError("Getters and setters are not supported by this ECMAScript engine")}else{desc.writable=desc.hasOwnProperty("writable")?desc.writable:defaultValue;desc.value=desc.hasOwnProperty("value")?desc.value:value}desc.enumerable=desc.hasOwnProperty("enumerable")?desc.enumerable:defaultValue;desc.configurable=desc.hasOwnProperty("configurable")?desc.configurable:defaultValue;var t=null;if((!desc[t="configurable"])||(!desc[t="enumerable"])||(!desc[t="writable"])){throw new TypeError("Property '".concat(t,"' cannot be set to false in this version of ECMAScript engine"))}return desc};if(!Object.defineProperty){Object.defineProperty=function(obj,property,descriptor){if(!__isObject(obj)){throw new TypeError(obj+" is not an object")}var pname=String(property);var desc=__toPropertyDescriptor(descriptor);desc=__applyDefaults(desc,obj.hasOwnProperty(pname),obj[pname]);obj[pname]=desc.value;return obj};Object.defineProperty.DDRECMA5=true}if(!Object.defineProperties){Object.defineProperties=function(obj,properties){if(!__isObject(obj)){throw new TypeError(obj+" is not an object")}var properties=Object(properties);var descriptors={};for(var key in properties){if(properties.hasOwnProperty(key)){var desc=__toPropertyDescriptor(properties[key]);descriptors[key]=__applyDefaults(desc,obj.hasOwnProperty(key),obj[key])}}for(key in descriptors){if(properties.hasOwnProperty(key)){obj[key]=descriptors[key].value}}return obj};Object.defineProperties.DDRECMA5=true}})();Object.keys||(Object.keys=function(obj){if(!__isObject(obj)){throw new TypeError(obj+" is not an object")}var results=[];for(var key in obj){(obj.hasOwnProperty?obj.hasOwnProperty(key):key in obj)&&results.push(key)}if(__isString(obj)&&!__features.STRING_INDEX_ENUMERABLE){for(var i=0,len=obj.length;i<len;++i){results.push(String(i))}}return results});!Object.getOwnPropertyNames&&(function(){var __notEnumerableProperties=(function(){var props=[{object:Object,keys:["getOwnPropertyNames","seal","create","isFrozen","keys","isExtensible","getOwnPropertyDescriptor","preventExtensions","getPrototypeOf","defineProperty","isSealed","defineProperties","freeze"]},{object:Object.prototype,keys:["toString","__lookupGetter__","__defineGetter__","toLocaleString","hasOwnProperty","valueOf","__defineSetter__","propertyIsEnumerable","isPrototypeOf","__lookupSetter__"]},{object:Function.prototype,keys:["bind","arguments","toString","length","call","name","apply","caller"]},{object:Number,keys:["NaN","NEGATIVE_INFINITY","POSITIVE_INFINITY","MAX_VALUE","MIN_VALUE"]},{object:Number.prototype,keys:["toExponential","toString","toLocaleString","toPrecision","valueOf","toFixed"]},{object:String,keys:["fromCharCode"]},{object:String.prototype,keys:["length","concat","localeCompare","substring","italics","charCodeAt","strike","indexOf","toLowerCase","trimRight","toString","toLocaleLowerCase","replace","toUpperCase","fontsize","trim","split","substr","sub","charAt","blink","lastIndexOf","sup","fontcolor","valueOf","link","bold","anchor","trimLeft","small","search","fixed","big","match","toLocaleUpperCase","slice"]},{object:Boolean.prototype,keys:["toString","valueOf"]},{object:Date,keys:["now","UTC","parse"]},{object:Date.prototype,keys:["toUTCString","setMinutes","setUTCMonth","getMilliseconds","getTime","getMinutes","getUTCHours","toString","setUTCFullYear","setMonth","getUTCMinutes","getUTCDate","setSeconds","toLocaleDateString","getMonth","toTimeString","toLocaleTimeString","setUTCMilliseconds","setYear","getUTCFullYear","getFullYear","getTimezoneOffset","setDate","getUTCMonth","getHours","toLocaleString","toISOString","toDateString","getUTCSeconds","valueOf","setUTCMinutes","getUTCDay","toJSON","setUTCDate","setUTCSeconds","getYear","getUTCMilliseconds","getDay","setFullYear","setMilliseconds","setTime","setHours","getSeconds","toGMTString","getDate","setUTCHours"]},{object:RegExp,keys:["$*","$`","$input","$+","$&","$'","$_"]},{object:RegExp.prototype,keys:["toString","exec","compile","test"]},{object:Error.prototype,keys:["toString"]},{object:Math,keys:["LN10","PI","E","LOG10E","SQRT2","LOG2E","SQRT1_2","LN2","cos","pow","log","tan","sqrt","ceil","asin","abs","max","exp","atan2","random","round","floor","acos","atan","min","sin"]},{object:global,keys:["TypeError","decodeURI","parseFloat","Number","URIError","encodeURIComponent","RangeError","ReferenceError","RegExp","Array","isNaN","Date","Infinity","Boolean","Error","NaN","String","Function","Math","undefined","encodeURI","escape","unescape","decodeURIComponent","EvalError","SyntaxError","Object","eval","parseInt","JSON","isFinite"]},{test:function(obj){return typeof JSON!=="undefined"&&obj===JSON},keys:["stringify","parse"]},{test:function(obj){return Array.isArray(obj)||__isString(obj)},keys:["length"]},{test:function(obj){return obj instanceof RegExp},testValue:new RegExp(".+"),keys:["lastIndex","multiline","global","source","ignoreCase"]},{test:function(obj){return typeof obj==="function"&&obj.apply&&obj.call},testValue:function(a,b,c){},keys:["arguments","length","name","prototype","caller"]}];for(var i=0,ilen=props.length;i<ilen;++i){if(props[i].object){if(typeof props[i].object==="function"){props[i].keys.push("arguments","length","name","prototype","caller")}else{if(typeof props[i].object==="object"&&props[i].object!==Math&&props[i].object!==global){props[i].keys.push("constructor")}}for(var j=props[i].keys.length-1;j>=0;--j){if(!(props[i].keys[j] in props[i].object)||__propertyIsEnumerable(props[i].object,props[i].keys[j])){props[i].keys.splice(j,1)}}}else{if(props[i].test&&props[i].testValue&&props[i].test(props[i].testValue)){for(var j=props[i].keys.length-1;j>=0;--j){if(!(props[i].keys[j] in props[i].testValue)||__propertyIsEnumerable(props[i].testValue,props[i].keys[j])){props[i].keys.splice(j,1)}}delete props[i].testValue}}}return props})();var __len=__notEnumerableProperties.length;Object.getOwnPropertyNames=function(obj){var keys=Object.keys(obj);for(var i=0;i<__len;++i){if((__notEnumerableProperties[i].object&&__notEnumerableProperties[i].object===obj)||(__notEnumerableProperties[i].test&&__notEnumerableProperties[i].test(obj))){keys=keys.concat(__notEnumerableProperties[i].keys);break}}return keys}})();var __isObject=function(obj){return obj&&(typeof obj==="object"||typeof obj==="function")};var __isString=function(obj){return typeof obj==="string"||Object.prototype.toString.call(obj)==="[object String]"};var __firstIndex=function(arr){for(var k=0,len=arr.length;k<len;++k){if(arr.hasOwnProperty(String(k))){return k}}return -1};var __toPropertyDescriptor=function(obj){if(!obj||typeof obj!=="object"){throw new TypeError(obj+" is not an object")}var desc={};obj.hasOwnProperty("enumerable")&&(desc.enumerable=!!obj.enumerable);obj.hasOwnProperty("configurable")&&(desc.configurable=!!obj.configurable);obj.hasOwnProperty("writable")&&(desc.writable=!!obj.writable);obj.hasOwnProperty("value")&&(desc.value=obj.value);if(obj.hasOwnProperty("get")){if(!__isCallable(obj.get)&&typeof obj.get!=="undefined"){throw new TypeError("Getter must be a callable object")}desc.get=obj.get}if(obj.hasOwnProperty("set")){if(!__isCallable(obj.set)&&typeof obj.set!=="undefined"){throw new TypeError("Setter must be a callable object")}desc.set=obj.set}if((desc.hasOwnProperty("get")||desc.hasOwnProperty("set"))&&(desc.hasOwnProperty("writable")||desc.hasOwnProperty("value"))){throw new TypeError("Invalid property. A property cannot both have accessors and be writable or have a value")}return desc};var __isCallable=(function(){var __sortCase=(function(){try{[].sort("abc");return false}catch(ex){return true}})();return function(obj){if(typeof obj==="function"){return true}if(typeof obj!=="object"){return false}if(obj instanceof Function||obj instanceof RegExp){return true}if(__sortCase){try{[].sort(obj);return true}catch(ex){}}return false}})()})(this);Object.defineProperties(Array,{intersect:{value:function intersect(arrays){return arrays.first().filter(function(val){return arrays.every(function(arg){return arg.contains(val)})})},writable:true,enumerable:false,configurable:true},diff:{value:function diff(arrays){var vals=arrays.flatten(1);return vals.filter(function(a){return vals.indexOf(a)==vals.lastIndexOf(a)})},writable:true,enumerable:false,configurable:true},union:{value:function union(arrays){return Array.prototype.concat.apply([],arrays).unique()},writable:true,enumerable:false,configurable:true},range:{value:function range(start,stop,step){if(stop===undefined){stop=start;start=1}var arr=[];for(var i=start;i<=stop;i+=(step||1)){arr.push(i)}return arr},writable:true,enumerable:false,configurable:true}});Object.defineProperties(Array.prototype,{swap:{value:function swap(index1,index2){var value=this[index1];this[index1]=this[index2];this[index2]=value;return this},writable:true,enumerable:false,configurable:true},contains:{value:function contains(values){args=Array.prototype.slice.call(arguments);return args.every(function(arg){return !!~this.indexOf(arg)}.bind(this))},writable:true,enumerable:false,configurable:true},remove:{value:function remove(){args=Array.prototype.slice.call(arguments);args.forEach(function(arg){if(this.contains(arg)){this.splice(this.indexOf(arg),1)}}.bind(this));return this},writable:true,enumerable:false,configurable:true},shuffle:{value:function shuffle(){var arr=this.clone();for(var index=0;index<arr.length-1;index++){arr.swap(index,Number.random(index,arr.length-1).round())}return arr},writable:true,enumerable:false,configurable:true},shuffle$:{value:function shuffle$(){for(var index=0;index<this.length-1;index++){this.swap(index,Number.random(index,this.length-1).round())}return this},writable:true,enumerable:false,configurable:true},clone:{value:function clone(){return this.slice()},writable:true,enumerable:false,configurable:true},intersect:{value:function intersect(){return Array.intersect(Array.prototype.slice.call(arguments).concat([this]))},writable:true,enumerable:false,configurable:true},diff:{value:function diff(){return Array.diff(Array.prototype.slice.call(arguments).concat([this]))},writable:true,enumerable:false,configurable:true},union:{value:function union(){return Array.union(Array.prototype.slice.call(arguments).concat([this]))},writable:true,enumerable:false,configurable:true},chunk:{value:function chunk(size){for(var arr=[];this.length>0;arr.push(this.splice(0,size))){}return arr},writable:true,enumerable:false,configurable:true},chunk$:{value:function chunk$(size){for(var i=0,length=this.length/size;i<length;i++){this.splice(i,0,this.splice(i,size))}return this},writable:true,enumerable:false,configurable:true},unique:{value:function unique(){return this.filter(function(a,idx){return this.indexOf(a)==idx}.bind(this))},writable:true,enumerable:false,configurable:true},each:{value:function each(callback){var idx,result;for(idx in this){if((result=callback.call(null,this[idx],idx,this))!==undefined){return result}}},writable:true,enumerable:false,configurable:true},flatten:{value:function flatten(level){if(level===undefined){level=-1}else{if(level==0){return this.clone()}}return this.reduce(function(a,b){return a.concat((Array.isArray(b)&&level!=0)?b.flatten(level-1):[b])},[])},writable:true,enumerable:false,configurable:true},flatten$:{value:function flatten$(level){if(level===undefined){level=-1}for(var i=0,length=this.length;i<length;i++){if(Array.isArray(this[i])&&level!=0){this.splice.apply(this,[i,1].concat(this[i].flatten(level-1)))}}return this},writable:true,enumerable:false,configurable:true},sum:{value:function sum(){return this.reduce(function(a,b){return Number(a)+Number(b)})},writable:true,enumerable:false,configurable:true},product:{value:function product(){return this.reduce(function(a,b){return Number(a)*Number(b)})},writable:true,enumerable:false,configurable:true},first:{value:function first(num){return num?this.slice(0,num||1):this[0]},writable:true,enumerable:false,configurable:true},last:{value:function last(num){return num?this.slice(this.length-(num||1)):this[this.length-1]},writable:true,enumerable:false,configurable:true},clean:{value:function clean(){return this.filter(function(val){return !!val})},writable:true,enumerable:false,configurable:true},clean$:{value:function clean$(){return this.filter$(function(val){return !!val})},writable:true,enumerable:false,configurable:true},filter$:{value:function filter$(callback,scope){for(var i=0;i<this.length;i++){if(!callback.call(scope,this[i],i,this)){this.splice(i,1)&&i--}}return this},writable:true,enumerable:false,configurable:true},map$:{value:function map$(callback,scope){for(var i=0;i<this.length;i++){this[i]=callback.call(scope,this[i],i,this)}return this},writable:true,enumerable:false,configurable:true},invoke:{value:function invoke(callback){return this.map(function(val){return val[callback].apply(val,Array.prototype.slice.call(this,1))},arguments)},writable:true,enumerable:false,configurable:true},invoke$:{value:function invoke$(callback){return this.map$(function(val){return val[callback].apply(val,Array.prototype.slice.call(this,1))},arguments)},writable:true,enumerable:false,configurable:true},pluck:{value:function pluck(prop){return this.map(function(val){if(Array.isArray(prop)){return Object.filter(val,prop)}return val[prop]})},writable:true,enumerable:false,configurable:true},pluck$:{value:function pluck$(prop){return this.map$(function(val){if(Array.isArray(prop)){return Object.filter(val,prop)}return val[prop]})},writable:true,enumerable:false,configurable:true},grep:{value:function grep(regex){return this.filter(function(val){return !!val.match(regex)})},writable:true,enumerable:false,configurable:true},grep$:{value:function grep$(regex){return this.filter$(function(val){return !!val.match(regex)})},writable:true,enumerable:false,configurable:true},sort$:{value:function sort$(sort){var sorted=this.sort(sort);sorted.forEach(function(val,i){this[i]=val},this);return this},writable:true,enumerable:false,configurable:true},sortBy:{value:function sortBy(cmp,sort){if(cmp===undefined){return this.sort(sort)}if(sort===undefined){sort=function(a,b){return a>b}}var arr=this[typeof cmp==="function"?"map":"pluck"](cmp);arr=arr.map(function(val,i){return{key:i,val:val}});return arr.sort(function(a,b){return sort.call(null,a.val,b.val)}).map(function(val){return this[val.key]},this)},writable:true,enumerable:false,configurable:true},sortBy$:{value:function sortBy$(cmp,sort){this.sortBy(cmp,sort).forEach(function(v,i){this[i]=v},this);return this},writable:true,enumerable:false,configurable:true},fetch:{value:function fetch(order){if(typeof order=="function"){order=this.map(order)}if(!Array.isArray(order)){order=Array.prototype.slice.call(arguments)}var arr=[];order.forEach(function(o,i){arr[o]=this[i]},this);return arr},writable:true,enumerable:false,configurable:true}});Object.defineProperties(Function,{compose:{value:function compose(funcs){if(!Array.isArray(funcs)){funcs=Array.prototype.slice.call(arguments)}funcs=funcs.reverse();return function(arg){return funcs.reduce(function(a,b){return b(a)},arg)}},writable:true,enumerable:false,configurable:true}});Object.defineProperties(Function.prototype,{cache:{value:function cache(time,ident){time=isNaN(time)?-1:time;ident=ident||function(id){return(typeof id=="object")?Object.id(id):id.toString()};var cache={},callback=this,timeouts={};return function(){var args=Array.prototype.slice.call(arguments),id="("+args.map(ident).join(",")+")";if(!(id in cache)){cache[id]=callback.apply(callback,args)}else{if(id in timeouts){clearTimeout(timeouts[id]);delete timeouts[id]}}if(time>0){timeouts[id]=setTimeout(function(){delete cache[id]},time)}return cache[id]}},writable:true,enumerable:false,configurable:true},delay:{value:function delay(callback,time,scope){return setTimeout(function(args){callback.apply(scope,[this()].concat(Array.prototype.slice.call(args,2)))}.bind(this,arguments),time)},writable:true,enumerable:false,configurable:true},once:{value:function once(scope){var called=false,val=null;return function(args){if(!called){called=true;val=this.apply(scope,args)}return val}.bind(this,Array.prototype.slice.call(arguments))},writable:true,enumerable:false,configurable:true}});Object.defineProperties(Number,{random:{value:function random(start,end){return(start=start||0)+(((end||start+1)-start)*Math.random())},writable:true,enumerable:false,configurable:true}});Object.defineProperties(Number.prototype,{chr:{get:function(){return String.fromCharCode(this)},enumerable:false,configurable:true},odd:{get:function(){return !this.even},enumerable:false,configurable:true},even:{get:function(){return(this%2)==0},enumerable:false,configurable:true},gcd:{value:function gcd(){return Array.prototype.slice.call(arguments).reduce(function(a,b){if(a==0||b==0){return a|b}for(var shift=0;((a|b)&1)==0;shift++){a>>=1;b>>=1}while((a&1)==0){a>>=1}do{while((b&1)==0){b>>=1}if(a<b){b-=a}else{var diff=a-b;a=b;b=diff}b>>=1}while(b!=0);return a<<shift},this)},writable:true,enumerable:false,configurable:true},lcm:{value:function lcm(){var nums=Array.prototype.slice.call(arguments),gcd=this.gcd.apply(this,nums);return Math.abs(nums.product()*this)/gcd},writable:true,enumerable:false,configurable:true},ceil:{value:function ceil(){return Math.ceil(this)},writable:true,enumerable:false,configurable:true},floor:{value:function floor(){return Math.floor(this)},writable:true,enumerable:false,configurable:true},abs:{value:function abs(){return Math.abs(this)},writable:true,enumerable:false,configurable:true},round:{value:function round(digits){digits=digits||0;if(digits==0){return Math.round(this)}else{if(digits<0){return Number(this.toPrecision(this.floor().toString().length-digits.abs()))}else{return Number(this.toFixed(digits))}}},writable:true,enumerable:false,configurable:true},radix:{value:function radix(base,size,character){return this.toString(base).pad(-size,(character||"0"))},writable:true,enumerable:false,configurable:true},bin:{value:function bin(size,character){return this.radix(2,size,character)},writable:true,enumerable:false,configurable:true},oct:{value:function oct(size,character){return this.radix(8,size,character)},writable:true,enumerable:false,configurable:true},dec:{value:function dec(size,character){return this.radix(10,size,character)},writable:true,enumerable:false,configurable:true},hexl:{value:function hexl(size,character){return this.radix(16,size,character)},writable:true,enumerable:false,configurable:true},hex:{value:function hex(size,character){return this.radix(16,size,character).toUpperCase()},writable:true,enumerable:false,configurable:true},abbr:{value:function abbr(digits,binary){binary=!!(binary==undefined?false:binary);var prefixes={k:binary?1<<10:1000,M:binary?1<<20:1000000,G:binary?1<<30:1000000000,T:binary?Math.pow(2,40):1000000000000,P:binary?Math.pow(2,50):1000000000000000,E:binary?Math.pow(2,60):1000000000000000000,Z:binary?Math.pow(2,70):1e+21,Y:binary?Math.pow(2,80):1e+24};var keys=Object.keys(prefixes),divs=Object.values(prefixes);if(divs[0]>this){return this.toFixed(digits)}for(var i=0;i<divs.length;i++){if((this/divs[i])<1){return(this/divs[i-1]).toFixed(digits)+keys[i-1]}}return(this/divs.last()).toFixed(digits)+keys.last()},writable:true,enumerable:false,configurable:true}});Object.defineProperties(Object,{id:{value:function id(obj){id.store=id.store||[];if(!id.store.contains(obj)){id.store.push(obj)}return id.store.indexOf(obj)},writable:true,enumerable:false,configurable:true},alias:{value:function alias(object,property,alias,complete){var desc=Object.getOwnPropertyDescriptor(object,property);if(!complete){Object.defineProperty(object,alias,desc)}else{if(("get" in desc)||("value" in desc)){delete desc.value,delete desc.writable;desc.get=function(){return object[property]}}desc.set=function(val){return object[property]=val};Object.defineProperty(object,alias,desc)}return object},writable:true,enumerable:false,configurable:true},values:{value:function values(obj){var arr=[];for(key in obj){arr.push(obj[key])}return arr},writable:true,enumerable:false,configurable:true},forEach:{value:function forEach(obj,callback,scope){return Object.keys(obj).forEach(function(key){return callback.call(null,key,obj[key],obj)})},writable:true,enumerable:false,configurable:true},isObject:{value:function isObject(){return Object.values(arguments).every(function(value){return typeof value==="object"&&Object(value)===value})},writable:true,enumerable:false,configurable:true},each:{value:function each(obj,callback,scope){var key,result;for(key in obj){if((result=callback.call(null,key,obj[key],this))!==undefined){return result}}},writable:true,enumerable:false,configurable:true},map:{value:function map(object,callback,scope){var obj=Object.clone(object);Object.map$(obj,callback,scope);return obj},writable:true,enumerable:false,configurable:true},map$:{value:function map$(obj,callback,scope){Object.forEach(obj,function(key,val){obj[key]=callback.call(scope,key,val)});return obj},writable:true,enumerable:false,configurable:true},getOwnPropertyDescriptors:{value:function getOwnPropertyDescriptors(object){var descriptors={};Object.getOwnPropertyNames(object).forEach(function(key){descriptors[key]=Object.getOwnPropertyDescriptor(object,key)});return descriptors},writable:true,enumerable:false,configurable:true},walk:{value:function walk(obj,callback){Object.forEach(obj,function(key,val){obj[key]=callback.call(null,key,val)});return obj},writable:true,enumerable:false,configurable:true},reduce:{value:function reduce(obj,callback,start){Object.forEach(obj,function(key,val){start=callback.call(null,start,key,obj[key])});return start},writable:true,enumerable:false,configurable:true},merge:{value:function merge(objects,level){if(Object.isObject(objects,level)){objects=Object.values(arguments),level=0}level=(level===undefined)?0:level;return objects.reduce(function(group,obj){Object.forEach(obj,function(key,val){if(!val in group||level==0||!Object.isObject(group[key])||!Object.isObject(val)){group[key]=val}else{group[key]=Object.merge([group[key],val],level-1)}});return group},{})},writable:true,enumerable:false,configurable:true},merge$:{value:function copy(object,objects,level){if(Array.isArray(objects)){objects=[object].concat(objects)}else{objects=Array.prototype.slice.call(arguments);level=undefined}var obj=Object.merge.apply(null,objects,level);this.filter$(function(key,val){return(key in obj)});this.map$(function(key,val){return obj[key]});Object.keys(obj).diff(Object.keys(this)).forEach(function(key){object[key]=obj[key]});return object},writable:true,enumerable:false,configurable:true},clone:{value:function clone(obj,inherit){inherit=(inherit===undefined)?true:false;return Object.create(Object.getPrototypeOf(obj),inherit?Object.getOwnPropertyDescriptors(obj):undefined)},writable:true,enumerable:false,configurable:true},filter:{value:function filter(object,callback,scope){return Object.filter$(Object.clone(object),callback,scope)},writable:true,enumerable:false,configurable:true},filter$:{value:function filter$(obj,callback,scope){if(Array.isArray(callback)){var keys=callback.invoke("toString")}Object.forEach(obj,function(key,val){if(Array.isArray(callback)){if(!keys.contains(key)){delete obj[key]}}else{if(callback.call(scope,key,val,obj)===false){delete obj[key]}}});return obj},writable:true,enumerable:false,configurable:true},clean:{value:function clean(obj){return Object.filter(obj,function(key,val){return !!val})},writable:true,enumerable:false,configurable:true},clean$:{value:function clean$(obj){return Object.filter$(obj,function(key,val){return !!val})},writable:true,enumerable:false,configurable:true},size:{value:function size(obj){return Object.keys(obj).length},writable:true,enumerable:false,configurable:true},combine:{value:function combine(keys,values){var obj={};keys.forEach(function(key,i){obj[key]=values[i]});return obj},writable:true,enumerable:false,configurable:true},hash:{value:function hash(object){return Object.hash$(Object.clone(object))},writable:true,enumerable:false,configurable:true},hash$:{value:function hash$(object){return Object.defineProperties(object,{length:{get:function(){return Object.size(this)},enumerable:false,configurable:true},keys:{value:function keys(callback,scope){return Object.keys(this)},writable:true,enumerable:false,configurable:true},each:{value:function each(callback,scope){return Object.each(this,callback,scope)},writable:true,enumerable:false,configurable:true},forEach:{value:function forEach(callback,scope){return Object.forEach(this,callback,scope)},writable:true,enumerable:false,configurable:true},map:{value:function map(callback,scope){return Object.map(this,callback,scope)},writable:true,enumerable:false,configurable:true},map$:{value:function map$(callback,scope){return Object.map$(this,callback,scope)},writable:true,enumerable:false,configurable:true},reduce:{value:function reduce(callback,start){return Object.reduce(this,callback,start)},writable:true,enumerable:false,configurable:true},filter:{value:function filter(callback,scope){return Object.filter(this,callback,scope)},writable:true,enumerable:false,configurable:true},filter$:{value:function filter$(callback,scope){return Object.filter$(this,callback,scope)},writable:true,enumerable:false,configurable:true},clean:{value:function clean(callback,scope){return Object.clean(this,callback,scope)},writable:true,enumerable:false,configurable:true},clean$:{value:function clean$(callback,scope){return Object.clean$(this,callback,scope)},writable:true,enumerable:false,configurable:true},clone:{value:function clone(callback,scope){return Object.clone(this,callback,scope)},writable:true,enumerable:false,configurable:true},merge:{value:function merge(){return Object.merge.apply(undefined,[this].concat(Array.prototype.slice.call(arguments)))},writable:true,enumerable:false,configurable:true},merge$:{value:function merge$(){return Object.merge$.apply(undefined,[this].concat(Array.prototype.slice.call(arguments)))},writable:true,enumerable:false,configurable:true}})},writable:true,enumerable:false,configurable:true}});Object.defineProperties(String,{UUID:{value:function UUID(){return Array.range(0,35).map(function(i){switch(i){case 8:case 13:case 23:return"-";case 14:i=4;break;case 19:i=(Number.random(0,16).floor()&3)|8;break;default:i=Number.random(0,16).floor();break}return"0123456789ABCDEF"[i]}).join("")},writable:true,enumerable:false,configurable:true}});Object.defineProperties(String.prototype,{chars:{value:function chars(obj){for(var i=0,arr=[];i<this.length;i++){arr.push(this.charAt(i))}return arr},writable:true,enumerable:false,configurable:true},count:{value:function count(substr,mod){return this.match(RegExp(substr,mod||"gi")).length},writable:true,enumerable:false,configurable:true},insert:{value:function insert(substr,pos){return this.substr(0,pos||0)+substr+this.substr(pos||0)},writable:true,enumerable:false,configurable:true},remove:{value:function remove(substr){return this.replace(substr,"")},writable:true,enumerable:false,configurable:true},reverse:{value:function reverse(){return this.chars().reverse().join("")},writable:true,enumerable:false,configurable:true},ucfirst:{value:function ucfirst(){return this[0].toUpperCase()+this.substr(1)},writable:true,enumerable:false,configurable:true},swapcase:{value:function swapcase(){return this.chars().map(function(a){return/[a-z]/.test(a)?a.toUpperCase():a.toLowerCase()}).join("")},writable:true,enumerable:false,configurable:true},rpad:{value:function rpad(len,chars){len=Number(len);if(len<this.length){return this.valueOf()}for(var str=this;str.length<len;str+=(chars||" ")){}return str.substr(0,len)},writable:true,enumerable:false,configurable:true},lpad:{value:function lpad(len,chars){len=Number(len);if(len<this.length){return this.valueOf()}chars=(chars||" ").reverse();for(var str=this;str.length<len;str=(chars+str)){}return str.substr(str.length-len)},writable:true,enumerable:false,configurable:true},pad:{value:function pad(len,chars){return this[len>0?"rpad":"lpad"](Math.abs(len),chars)},writable:true,enumerable:false,configurable:true},soundex:{value:function soundex(){return this.substr(0,1).toUpperCase()+this.toUpperCase().substr(1).remove(/[^A-Z]/gi).trim().replace(/DG/g,"G").replace(/GH/g,"H").replace(/GN|KN/g,"N").replace(/PH/g,"F").replace(/MP([STZ])/g,"M$1").replace(/^PS/g,"S").replace(/^PF/g,"F").replace(/MB/g,"M").replace(/TCH/g,"CH").replace(/[AEIOUHWY]/g,"0").replace(/[BFPV]/g,"1").replace(/[CGJKQSXZ]/g,"2").replace(/[DT]/g,"3").replace(/[L]/g,"4").replace(/[MN]/g,"5").replace(/[R]/g,"6").replace(/(\w)\1+/g,"$1").slice(0,3).rpad(3,"0")},writable:true,enumerable:false,configurable:true},distance:{value:function distance(c){var s,l=(s=this.split("")).length,t=(c=c.split("")).length,i,j,m,n;if(!(l||t)){return Math.max(l,t)}for(var a=[],i=l+1;i;a[--i]=[i]){}for(i=t+1;a[0][--i]=i;){}for(i=-1,m=s.length;++i<m;){for(j=-1,n=c.length;++j<n;){a[(i*=1)+1][(j*=1)+1]=Math.min(a[i][j+1]+1,a[i+1][j]+1,a[i][j]+(s[i]!=c[j]))}}return a[l][t]},writable:true,enumerable:false,configurable:true},soundex:{value:function soundex(){return this.substr(0,1).toUpperCase()+this.toUpperCase().substr(1).remove(/[^A-Z]/gi).trim().replace(/DG/g,"G").replace(/GH/g,"H").replace(/GN|KN/g,"N").replace(/PH/g,"F").replace(/MP([STZ])/g,"M$1").replace(/^PS/g,"S").replace(/^PF/g,"F").replace(/MB/g,"M").replace(/TCH/g,"CH").replace(/[AEIOUHWY]/g,"0").replace(/[BFPV]/g,"1").replace(/[CGJKQSXZ]/g,"2").replace(/[DT]/g,"3").replace(/[L]/g,"4").replace(/[MN]/g,"5").replace(/[R]/g,"6").replace(/(\w)\1+/g,"$1").rpad(3,"0")},writable:true,enumerable:false,configurable:true},sprintf:{value:function sprintf(c){var vals=arguments,regex=/%%|%(?:(\d+)[\$#])?([+-])?('.|0| )?(\d*)(?:\.(\d+))?([bcdfosuxX])/g;var index=0;return this.replace(regex,function(substr,flags,align,padding,width,precision,type){if(substr=="%%"){return"%"}flags=flags||"",align=align||"",padding=(padding||"").slice(-1)||" ",width=width||"",precision=precision||"";val=vals[+flags?flags-1:index];index++;if(type.match(/[duobxXf]{1}/)){val=Number(val)}else{val=String(val)}switch(type){case"d":case"u":return val.dec(align+width,padding);case"o":return val.oct(align+width,padding);case"b":return val.bin(align+width,padding);case"x":return val.hexl(align+width,padding);case"X":return val.hex(align+width,padding);case"s":return val.pad(align+width,padding);case"c":return String.fromCharCode(val).pad(align+width,padding);case"f":if(precision){val=val.toFixed(precision)}else{if(width){val=val.toExponential(width)}else{val=val.toExponential()}}align=align=="-"?"+":"-";return val.toString().pad(align+width,padding)}})},writable:true,enumerable:false,configurable:true}});